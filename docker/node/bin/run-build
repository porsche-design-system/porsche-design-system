#!/usr/bin/env bash

set -o errexit
set -o pipefail

if
  [[ "--core-dependencies" == "${1}" ]] ||
  [[ "--assets" == "${1}" ]] ||
  [[ "--icons" == "${1}" ]] ||
  [[ "--fonts" == "${1}" ]] ||
  [[ "--marque" == "${1}" ]] ||
  [[ "--meta-icons" == "${1}" ]] ||
  [[ "--components" == "${1}" ]] ||
  [[ "--components-prod" == "${1}" ]] ||
  [[ "--components-js" == "${1}" ]] ||
  [[ "--components-js-prod" == "${1}" ]] ||
  [[ "--components-angular" == "${1}" ]] ||
  [[ "--components-react" == "${1}" ]] ||
  [[ "--shared" == "${1}" ]] ||
  [[ "--storefront" == "${1}" ]] ||
  [[ "--utilities" == "${1}" ]]
then
  yarn build:${1:2}
else
  yarn build
fi

OSS_OFFICE_AWS_ECR_REGISTRY='12 3'

docker run -v "$PWD":/project "${{ env.OSS_OFFICE_AWS_ECR_REGISTRY }}/ort-porsche":latest analyze -i /project/ -o /project/ort/ --package-managers yarn
docker run -v "$PWD":/project 215495424956.dkr.ecr.eu-central-1.amazonaws.com/ort-porsche:latest report -i /project/ort/analyzer-result.yml -o /project/ort/ -f StaticHtml
