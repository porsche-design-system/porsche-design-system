on:
  push:
    branches:
      - master
      - v*
      - issue/*
      - housekeeping/*
      - release/*
name: 'OSS Review Toolkit'
jobs:
  ort:
    name: 'ORT'
    runs-on: ubuntu-latest
    steps:
      - name: 'Checkout'
        uses: actions/checkout@v2
      - name: 'Setup npm credentials'
        run: echo "//porscheui.jfrog.io/porscheui/api/npm/npm/:_authToken=${{ secrets.PORSCHE_NPM_REGISTRY_TOKEN }}" >> ./.npmrc
        shell: bash
      - name: 'ORT Docker Login'
        uses: ./.github/actions/ort-docker-login
        with:
          user: ${{ secrets.DOCKER_OSS_OFFICE_USER }}
          password: ${{ secrets.DOCKER_OSS_OFFICE_PASSWORD }}
      - name: 'Store ORT Analysis'
        uses: actions/upload-artifact@v2
        with:
          name: ort-analysis
          path: ./ort
      - name: 'Cleanup npm credentials'
        run: rm ./.npmrc
        shell: bash
