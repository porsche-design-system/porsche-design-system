<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Porsche Design System - Playground</title>
    <base href="/" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <script nomodule src="build/porsche-design-system.js"></script>
    <script type="module" src="build/porsche-design-system.esm.js"></script>
  </head>
  <body>
    <p-headline>table-wrapper</p-headline>
    <p-table-wrapper>
      <table>
        <thead></thead>
        <tbody></tbody>
      </table>
    </p-table-wrapper>
    <br />

    <p-headline>table-wrapper-body</p-headline>
    <p-table-wrapper-body></p-table-wrapper-body>
    <br />

    <p-headline>table</p-headline>
    <p-table></p-table>
    <br />

    <p-headline>table-two</p-headline>
    <p-table-two></p-table-two>
    <br />

    <p-headline>table-three</p-headline>
    <p-table-three>
      <template>
        <tr>
          <td><img src="${imageUrl}" width="80px" /></td>
          <td>${firstName}</td>
          <td>${lastName}</td>
          <td>${company} GmbH</td>
          <td>${phoneNumber}</td>
          <td>${dateOfBirth}</td>
          <td>${location}<p-text weight="thin">(USA)</p-text></td>
        </tr>
      </template>
    </p-table-three>
    <br />

    <p-headline>table-generics</p-headline>
    <p-table-generics></p-table-generics>

    <!-- START: keep this snippet to log component lifecycle events -->
    <script>
      const head = ['Image', 'First name', 'Last name', 'Company', 'Phone', 'Birthday', 'Location'];
      const data = [
        {
          // id: '202829625',
          imageUrl: 'https://designsystem.porsche.com/latest/img/validation-fieldset.6feec63e.png',
          firstName: 'John',
          lastName: 'Locke',
          company: '',
          phoneNumber: '123123121',
          dateOfBirth: '1979-06-12',
          location: 'Boston',
        },
        {
          // id: '202829625',
          imageUrl: 'https://designsystem.porsche.com/latest/img/validation-fieldset.6feec63e.png',
          firstName: 'Matthias',
          lastName: 'Kainer',
          company: 'Company',
          phoneNumber: '',
          dateOfBirth: '1981-06-12',
          location: 'Bretten',
        },
        {
          // id: '202829625',
          imageUrl: 'https://designsystem.porsche.com/latest/img/validation-fieldset.6feec63e.png',
          firstName: 'Jason',
          lastName: 'Bourne',
          company: '',
          phoneNumber: '123123121',
          dateOfBirth: '1980-06-12',
          location: 'Berlin',
        },
        {
          // id: '202829625',
          imageUrl: 'https://designsystem.porsche.com/latest/img/validation-fieldset.6feec63e.png',
          firstName: 'Manni',
          lastName: 'Frisch',
          company: 'Company',
          phoneNumber: '',
          dateOfBirth: '1951-06-12',
          location: 'Hamburg',
        },
        {
          // id: '202829625',
          imageUrl: 'https://designsystem.porsche.com/latest/img/validation-fieldset.6feec63e.png',
          firstName: 'Jim',
          lastName: 'Bo',
          company: '',
          phoneNumber: '123123121',
          dateOfBirth: '1975-06-12',
          location: 'Köln',
        },
      ];
      const renderRow = ({ imageUrl, firstName, lastName, company, phoneNumber, dateOfBirth, location }) => `
      <tr>
        <td><a href="#${firstName}"><img src="${imageUrl}" width="80px"></a></td>
        <td><a href="#${firstName}">${firstName}</a></td>
        <td><a href="#${firstName}">${lastName}</a></td>
        <td><a href="#${firstName}">${company}</a></td>
        <td><a href="#${firstName}">${phoneNumber ? `# ${phoneNumber}` : ''}</a></td>
        <td><a href="#${firstName}">† ${dateOfBirth}</a></td>
        <td><a href="#${firstName}">${location}<p-text weight="thin">(Germany)</p-text></a></td>
      </tr>`;

      const table = document.querySelector('p-table');
      const table2 = document.querySelector('p-table-two');
      const table3 = document.querySelector('p-table-three');
      const tableGenerics = document.querySelector('p-table-generics');
      const tableWrapperBody = document.querySelector('p-table-wrapper-body');

      table.head = head;
      table.data = data;

      table2.head = head;
      table2.data = data;
      table2.renderRow = renderRow;

      table3.head = head;
      table3.data = data;

      tableWrapperBody.head = head;

      const dataKeys = Object.keys(data[0]);
      const headSortable = head.map((name, i) => ({ key: dataKeys[i], name, isSortable: i > 0, direction: 'asc' }));

      // tableGenerics.head = headSortable;
      // tableGenerics.data = data;
      tableGenerics.setAttribute('head', JSON.stringify(headSortable));
      tableGenerics.setAttribute('data', JSON.stringify(data));
      tableGenerics.renderRow = renderRow;

      tableGenerics.addEventListener('headClick', (e) => {
        console.log('headClick', e.detail);
        const { key, direction } = e.detail;

        const sortedHead = headSortable.map((x) => ({ ...x, isSorting: false, ...(x.key === key && e.detail) }));
        const sortedData = [...data].sort((a, b) =>
          direction === 'asc' ? a[key].localeCompare(b[key]) : b[key].localeCompare(a[key])
        );

        e.target.head = sortedHead;
        e.target.data = sortedData;
      });

      tableGenerics.addEventListener('rowClick', (e) => {
        console.log('rowClick', e.detail);
      });

      const tableHead = document.querySelector('thead');
      const tableHeadRow = document.createElement('tr');
      tableHead.appendChild(tableHeadRow);
      const tableBody = document.querySelector('tbody');

      head.forEach((item) => {
        const el = document.createElement('th');
        el.innerText = item;
        tableHeadRow.append(el);
      });

      data.forEach((item) => {
        const el = document.createElement('tr');
        Object.values(item).forEach((x) => {
          const elInner = document.createElement('td');
          elInner.innerText = x;
          el.append(elInner);
        });
        tableBody.append(el);
        tableWrapperBody.append(el.cloneNode(true));
      });

      ['componentWillLoad', 'componentDidLoad', 'componentWillUpdate', 'componentDidUpdate'].forEach((x) =>
        window.addEventListener(`stencil_${x}`, (e) => {
          const eventName = e.type + (e.type.includes('Did') ? ' ' : '');
          console.log(eventName, e.composedPath()[0].tagName.toLowerCase(), new Date().toISOString());
        })
      );
    </script>
    <!-- /END -->
  </body>
</html>
