<p-stepper-horizontal>
  <p-stepper-horizontal-item state="current"> Your content of Step 1</p-stepper-horizontal-item>
  <p-stepper-horizontal-item> Your content of Step 2</p-stepper-horizontal-item>
  <p-stepper-horizontal-item> Your content of Step 3</p-stepper-horizontal-item>
</p-stepper-horizontal>

<div id="step-content-0" tabindex="0">
  <p-text>Your content of Tab 1</p-text>
</div>
<div id="step-content-1" hidden tabindex="-1">
  <p-text>Your content of Tab 2</p-text>
</div>
<div id="step-content-2" hidden tabindex="-1">
  <p-text>Your content of Tab 3</p-text>
</div>

<p-button-group>
  <p-button icon="arrow-head-left" variant="tertiary" disabled="true">Previous Step</p-button>

  <p-button variant="primary">Next Step</p-button>
</p-button-group>

<script>
  const stepper = document.querySelector('p-stepper-horizontal');
  const steps = Array.from(document.querySelectorAll('p-stepper-horizontal-item'));
  const buttons = document.querySelectorAll('p-button');
  const panels = document.querySelectorAll('[id^="step-content"]');

  function getActiveStepIndex(steps) {
    return steps.findIndex((step) => step.state === 'current');
  }

  function displayContent(activeStepIndex) {
    if (activeStepIndex === 0) {
      buttons[0].setAttribute('disabled', 'true');
    } else {
      buttons[0].removeAttribute('disabled');
    }

    if (activeStepIndex === steps.length - 1) {
      buttons[1].setAttribute('disabled', 'true');
    } else {
      buttons[1].removeAttribute('disabled');
    }

    panels.forEach((panel, i) => {
      if (i === activeStepIndex) {
        panel.removeAttribute('hidden');
        panel.setAttribute('tabindex', '0');
      } else {
        panel.setAttribute('hidden', '');
        panel.setAttribute('tabindex', '-1');
      }
    });
  }

  function onNextPrevStep(direction) {
    const newState = [...steps];
    const activeStepIndex = getActiveStepIndex(newState);

    if (direction === 'next') {
      newState[activeStepIndex].state = 'complete';
      newState[activeStepIndex + 1].state = 'current';
      displayContent(activeStepIndex + 1);
    } else {
      newState[activeStepIndex].state = undefined;
      newState[activeStepIndex - 1].state = 'current';
      displayContent(activeStepIndex - 1);
    }
  }

  buttons.forEach((button, i) => button.addEventListener('click', () => onNextPrevStep(i === 0 ? 'prev' : 'next')));

  stepper.addEventListener('stepChange', (e) => {
    const { activeStepIndex } = e.detail;

    const newState = [...steps];
    newState[activeStepIndex].state = 'current';
    for (let i = activeStepIndex + 1; i < newState.length; i++) {
      // reset step state when going back via stepper horizontal item click
      newState[i].state = undefined;
    }

    displayContent(activeStepIndex);
  });
</script>
