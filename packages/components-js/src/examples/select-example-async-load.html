<p-select id="mySelect" name="options" value="a">
  <p-input-search
    id="inputSearch"
    name="Some name"
    clear="true"
    indicator="true"
    slot="filter"
    compact="true"
    auto-complete="off"
  ></p-input-search>
</p-select>

<script>
  const select = document.getElementById('mySelect');
  const inputSearch = document.getElementById('inputSearch');

  function setOptions(options) {
    Array.from(select.children)
      .filter(el => el.tagName.toLowerCase() === 'p-select-option')
      .forEach(el => select.removeChild(el));

    options.forEach(({ value, text }) => {
      const option = document.createElement('p-select-option');
      option.value = value;
      option.textContent = text;
      select.appendChild(option);
    });

    if (select.children.length > 0) {
      select.children[0].focus();
    }
  }

  select.addEventListener('toggle', (event) => {
    const isOpen = event.detail;

    if (isOpen) {
      const hasOptions = Array.from(select.children)
        .some(el => el.tagName.toLowerCase() === 'p-select-option');

      if (!hasOptions) {
        inputSearch.loading = true;

        setTimeout(() => {
          inputSearch.loading = false;

          setOptions([
            { value: 'a', text: 'Option A' },
            { value: 'b', text: 'Option B' },
            { value: 'c', text: 'Option C' }
          ]);
        }, 1000);
      }
    }
  });
</script>
